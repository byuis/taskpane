<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Script Foundry</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <script type="text/javascript" src="public.js"></script>
    <script type="text/javascript" src="system.js"></script>
    <script>
        Office.onReady((info) => {
        if (info.host === Office.HostType.Excel) {
            Excel.run(async (excel)=>{
                const code_module_ids_from_settings = excel.workbook.settings.getItemOrNullObject("code_module_ids").load("value");
                await excel.sync()
                //console.log("code_module_ids_from_settings",code_module_ids_from_settings.m_value)
                if(!code_module_ids_from_settings.isNullObject){
                    for(const xmlid of code_module_ids_from_settings.m_value){
                        code_module_ids.push(xmlid)
                    }
                }
                start_me_up()
            })
        }else{
            document.getElementById("sideload-msg").style.display = "flex"
            document.getElementById("menu").style.display = "none"
        }
        });
    </script>
    <style id="head_style" data-name="system">

body{
    margin: -5;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    background-color:rgb(252,239,205);
    font-size: 1.2rem;
    font-family: "Segoe UI Web (West European)",Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;
}
.ace-head{
    display:block;
    background-color: #36486b;
    padding: 3rem 1rem 1rem 1rem;
   
}
.ace-logo{
    display:inline-block;
    padding: 1rem;
    border-radius: 50%;
    background-color: white;
    margin: auto;
    display: table;
    
}

.ace-heading-1{
  font-weight: 100;
  color:white;
  font-size: 3rem;
  text-align:center;
  word-wrap: break-word;
  line-height: 100%;
}

.ace-heading-2{
    font-weight: 150;
    color:#800000;
    font-size: 2rem;
    word-wrap: break-word;
    line-height: 100%;
  }

  .ace-body{
      padding: 0 1.5rem 1.5rem 1.5rem;
  }
.ace-table{
        margin-left: auto;
        margin-right: auto;
        border-spacing: 1rem;

}
.ace-clickable{
  cursor:pointer

}  


.panel-selector{
                width:100%;
                margin:0;
                background-color: #36486b;
                color:white;
                font-weight: 100;
                padding:0 0 0 1.5rem;
                font-size: 1.2rem;

            }

.panel-selector-option{
    background-color: white;
    color:black;
}
.ace_editor { 
            position:absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            
        }   

.content{
    padding: 0 .5rem 0 .5rem
}
.editor-content{
    padding: 0
}
.top-corner{
    position:absolute;
    top:0;
    right:0;
}   
.hidden{
    display:none
}


</style>

</head>
<body>
  <div id="panel_introduction">  
    <div class="ace-head">
        <div class="ace-logo">
          <img width="90" height="90" src="https://byuis.github.io/taskpane/assets/logo-filled.png" alt="ACE" title="ACE" />
        </div>
        <h1 class="ace-heading-1">Atlas Code Environment</h1>
      </div> 
    <div class="ace-body"> 
    <h2  class="ace-heading-2">Store Javascript automations in your workbook.</h2>
      <table id="menu" class="ace-table">
        <tr id="open-editor" class="hidden">
            <td><i class="fas fa-laptop-code"></i></td>
            <td class="ace-clickable" onclick="open_editor()">Open Code Editor</td>
        </tr>

        <tr>
          <td><i class="far fa-window-maximize"></i></td>
          <td class="ace-clickable" onclick="toggle_element('add-module');tag('new-module-name').focus()">Add a Code Module</td>
        </tr>
        <tr id="add-module" class="hidden">
          <td></td>
          <td> <input id="new-module-name" size="10" placeholder="Module Name"/>
            <button id="module-add-button" onclick="add_code_module(tag('new-module-name').value)">Add</button></td>
        </tr>

        <tr>
            <td><i class="fas fa-file-import"></i></td>
          <td class="ace-clickable" onclick="toggle_element('import-module');tag('gist-url').focus()">Import a Code Module</td>
        </tr>
        <tr id="import-module" class="hidden">
          <td></td>
          <td> <input id="gist-url" size="10" placeholder="Gist Url"/>
            <button id="module-import-button" onclick="import_code_module(tag('gist-url').value)">Import</button></td>
        </tr>

        <tr>
          <td><i class="fas fa-graduation-cap"></i></td>
          <td class="ace-clickable" onclick="show_examples()">Show Examples</td>
        </tr>

        <tr>
          <td><i class="fas fa-list-ol"></i></td>
          <td class="ace-clickable" onclick="show_automations()">List Automations</td>
        </tr>

        <tr>
          <td><i class="fas fa-book"></i></td>
          <td class="ace-clickable">View Documentation</td>
        </tr>

        <tr>
          <td><i class="far fa-comment-alt"></i></td>
          <td class="ace-clickable">Send Feedback</td>
        </tr>
      </table>
    <section id="sideload-msg"  style="display:none">
        <h2 class="ace-heading-2">This addin must be run from inside Excel.</h2>
    </section>
    </div>
</div>
</body>

</html>
